<div class="row">
  <div class="col-md-12">
    <ul class="page-breadcrumb breadcrumb">
      <li>
	<i class="glyphicon glyphicon-menu-hamburger fg-red"></i>
	<a href="javascript:;" x-ng-bind=label>方案</a>
	<i class="glyphicon glyphicon-menu-right fg-red"></i>
      </li>
      <li class="active">
	<a href="javascript:;">新增</a>
      </li>
    </ul>    
  </div>
</div>


<div class="row">
  <div class="com-md-12">
    <div class="portlet box blue">
      <div class="portlet-body form">

	<!-- BEGIN form-->
	<form class="form-horizontal" name="rForm" novalidate>
	  <div class="form-body"> 
	    
	    <div class="form-group">
	      <label class="col-md-3 col-sm-3 control-label">名称</label>
	      <div class="col-sm-6 col-md-6"> 
		<div class="input-group">
		  <div x-ng-class="{'has-error':rForm.name.$invalid
				   && !rForm.name.$pristine}">
		    <input type="text"
			   class="form-control"
			   name="name"
			   required
			   placeholder="请输入方案名称" 
			   x-ng-model="promotion.name"
			   x-ng-pattern="pattern.name"/>
		  </div>
		  <span class="input-group-addon bg-white fg-red">*</span>
		</div> 
	      </div>
	      <div ng-if="rForm.name.$invalid && !rForm.name.$pristine">
		<span class="fg-red">
		  4-20个字符，只能是数字，字母，中文，横杠或下划线
		</span>
	      </div> 
	    </div>

	    <div class="form-group">
	      <label class="col-md-3 col-sm-3 control-label">充值规则</label>
	      <div class="col-sm-6 col-md-6">
		<div class="input-group">
		  <select class="form-control"
			  x-ng-model="promotion.rule"
			  x-ng-options="r as r.name for r in rules"> 
		  </select>
		  <span class="input-group-addon bg-white fg-red">*</span>
		</div> 
	      </div>
	    </div>

	    <div x-ng-if="promotion.rule.id===1" class="form-group">
	      <label class="col-md-3 col-sm-3 control-label">倍数</label>
	      <div class="col-sm-6 col-md-6">
		<div class="input-group">
		  <select class="form-control"
			  x-ng-model="promotion.time"
			  x-ng-options="t as t for t in times"> 
		  </select>
		  <span class="input-group-addon bg-white fg-red">*</span>
		</div> 
	      </div>
	    </div>

	    <div x-ng-if="promotion.rule.id===1" class="form-group">
	      <label class="col-md-3 col-sm-3 control-label">货品折扣</label>
	      <div class="col-sm-6 col-md-6">
		<div class="input-group">
		  <input class="form-control"
			 type="number" step="1"
			 name="xdiscount"
			 x-ng-pattern="pattern.number"
			 placeholder="请输入充值货品折扣,默认无折扣100"
			 x-ng-model="promotion.xdiscount" /> 
		  <span class="input-group-addon bg-white fg-red">*</span>
		</div> 
	      </div>
	    </div>

	    <div x-ng-if="promotion.rule.id===2" class="form-group">
	      <label class="col-md-3 col-sm-3 control-label">次数</label>
	      <div class="col-sm-6 col-md-6"> 
		<div class="input-group">
		  <div x-ng-class="{'has-error':rForm.ctime.$invalid && !rForm.ctime.$pristine}">
		    <input type="number" step="1"
			   class="form-control"
			   name="ctime"
			   required
			   placeholder="请输入次数" 
			   x-ng-model="promotion.ctime"
			   x-ng-pattern="pattern.number"/>
		  </div>
		  <span class="input-group-addon bg-white fg-red">*</span>
		</div> 
	      </div>
	      <div ng-if="rForm.ctime.$invalid && !rForm.ctime.$pristine">
		<span class="fg-red">次数只能是整数</span>
	      </div> 
	    </div>

	    <div x-ng-if="promotion.rule.id===0" class="form-group">
	      <label class="col-md-3 col-sm-3 control-label" x-ng-bind=label>金额(元)</label>
	      <div class="col-sm-6 col-md-6"> 
		<div class="input-group">
		  <div x-ng-class="{'has-error':rForm.charge.$invalid
				   && !rForm.charge.$pristine}">
		    <input type="number" step="1"
			   class="form-control"
			   name="charge"
			   required
			   placeholder="请输入充值金额" 
			   x-ng-model="promotion.charge"
			   x-ng-pattern="pattern.number"/>
		  </div>
		  <span class="input-group-addon bg-white fg-red">*</span>
		</div> 
	      </div>
	      <div ng-if="rForm.charge.$invalid && !rForm.charge.$pristine">
		<span class="fg-red">金额只能是数字</span>
	      </div> 
	    </div>

	    <div x-ng-if="promotion.rule.id===0 && action===0" class="form-group">
	      <label class="col-md-3 col-sm-3 control-label">赠送金额(元)</label>
	      <div class="col-sm-6 col-md-6"> 
		<div x-ng-class="{'has-error':rForm.balance.$invalid
				 && !rForm.balance.$pristine}">
		  <input type="number" step="1"
			 class="form-control"
			 name="balance"
			 placeholder="请输入减免金额，默认为0" 
			 x-ng-model="promotion.balance"
			 x-ng-pattern="pattern.number"/>
		</div>
	      </div>
	      <div ng-if="rForm.balance.$invalid && !rForm.balance.$pristine">
		<span class="fg-red">金额只能是数字</span>
	      </div> 
	    </div>

	    
	    <div class="form-group">
	      <label class="col-md-3 col-sm-3 control-label">开始日期</label>
	      <div class="col-md-6 col-sm-6">
		<time-search time="promotion.sdate"
			     click-ok="false">
		</time-search>
	      </div>
	    </div>

	    <div class="form-group">
	      <label class="col-md-3 col-sm-3 control-label">结束日期</label>
	      <div class="col-md-6 col-sm-6">
		<time-search time="promotion.edate"
			     click-ok="false">
		</time-search>
	      </div>
	    </div>

	    <div class="form-group">
	      <label class="col-md-3 col-sm-3 control-label">描述</label>
	      <div class="col-sm-6 col-md-6"> 
		<div x-ng-class="{'has-error':rForm.remark.$invalid
				 && !rForm.remark.$pristine}">
		  <input type="text"
			 class="form-control"
			 name="remark"
			 placeholder="请输入方案描述" 
			 x-ng-model="promotion.remark"
			 x-ng-pattern="pattern.remark"/>
		</div>
	      </div>
	      <div ng-if="rForm.remark.$invalid && !rForm.remark.$pristine">
		<span class="fg-red">请输入中文，字母，下划线或数字</span>
	      </div> 
	    </div> 
	  </div>

	  <!--BEGIN form action-->
	  <div class="form-actions fluid">
	    <div class="col-md-offset-3 col-md-6">
	      <span class="pull-right">
		<button class="btn btn-primary"
			ng-disabled="rForm.$invalid"
			x-ng-click="new_promotion()">确认</button>
		<button class="btn btn-warning"
			x-ng-click="cancel()">取消</button>
	      </span>
	    </div>
	  </div> <!--END form action-->
	  
	</form> <!--END form-->
	
      </div>
    </div>
  </div>
</div>
