<div class="row">
  <div class="col-md-12">
    <div class="portlet box purple">
      
      <div class="portlet-title">
	<div class="caption"><i class="glyphicon glyphicon-menu-hamburger"></i>
	  库存盘点
	</div>
	<div class="actions">
	  <button class="btn btn-info"
		    x-ng-disabled="disable_draft()"
		    x-ng-click="get_draft()">草稿
	      <i class="glyphicon glyphicon-send"></i></button> 
	  <button class="btn btn-success"
		  x-ng-disabled="disable_save()"
		  x-ng-click="save_inventory()">保存
	    <i class="glyphicon glyphicon-save"></i></button>
	  <button class="btn btn-danger"
		  x-ng-disabled="disable_refresh()"
		  x-ng-click="refresh()">下一单
	    <i class="glyphicon glyphicon-plus"></i></button>
	</div>
	<div class="tools">
	</div>
      </div>

      <!--BEGIN table container-->
      <div class="portlet-body">
	<div class="table-toolbar"> 
	  <div class="row diablo-form-group">
	    <div class="col-xs-3 col-md-3">
	      <div class="input-group">
		<span class="input-group-addon">
		  <i class="glyphicon glyphicon-calendar fg-red"></i>日期</span>
		<input type="text"
		       class="form-control"
		       readonly
		       x-ng-model="select.datetime"/> 
	      </div>
	    </div>
	    
	    <div class="col-xs-3 col-md-3">
	      <div class="input-group">
		<span class="input-group-addon">
		  <i class="glyphicon glyphicon-map-marker fg-red"></i>店铺</span>
	  	<select class="form-control" type="text"
	  		x-ng-model="select.shop"
	  		x-ng-options="s as s.name for s in shops|filter:$viewValue">
		</select>
	      </div>
	    </div>
	    
	    <div class="col-xs-3 col-md-3">
	      <div class="input-group">
		<span class="input-group-addon">
	  	  <i class="icon-user fg-red"></i>店员</span>
	  	<select class="form-control" type="text"
	  		x-ng-model="select.employee"
	  		x-ng-options="e as e.name for e in employees|filter:$viewValue">
		</select> 
	      </div>
	    </div>

	    <div class="col-xs-3 col-md-3">
	      <div class="input-group">
		<span class="input-group-addon">
	  	  <i class="icon-user fg-red"></i>数量</span>
	  	<input type="text"
		       class="form-control"
		       readonly
		       x-ng-model="select.total"/> 
	      </div>
	    </div>
	  </div> <!--END from-group--> 
	  
	</div>
	
	<!--BEGN portlet body--> 
	<div class="portlet-body">
	  <!--BEGIN panel-->
	  <div class="panel panel-default">
	    <div class="table-responsive">
	      <!--EBGIN table supplier-->
	      <table class="table table-bordered
			    table-striped table-hover table-condensed table-advanced">
		<thead>
		  <tr>
		    <th class="text-center">序号</th>
		    <th x-ng-if="setting.barcode_mode" class="text-center">条码</th> 
		    <th class="text-center">货号</th>
		    <!-- <th class="text-center">品名</th> -->
		    <!-- <th class="text-center">类别</th> -->
		    <th class="text-center">季节</th>
		    <th class="text-center">颜色</th>
		    <th class="text-center">尺码</th>
		    <th class="text-center">数量</th>
		    <th class="text-center">吊牌价</th> 
		    <th class="text-center">操作</th>
		  </tr>
		</thead>
		<tbody>
		  <!-- <tr class="text-center" ng-repeat="inv in inventories"> -->
		  <tr class="text-center" ng-repeat="inv in inventories">  
		    <td class="col-md-1">{{inv.order_id}}</td>
		    <td x-ng-if="setting.barcode_mode" class="col-md-2 text-left vert-align">
	  	      <span ng-if="!inv.$new">{{inv.full_bcode}}</span>
	  	      <form name="inv.form.bcode" ng-if="inv.$new">
	  		<div ng-class="{'has-error':inv.form.bcode.$invalid
	  			       && !inv.form.bcode.$pristine}">
	  		  <input class="form-control text-left"
	  			 type="text"
	  			 required
	  			 x-ng-model="inv.full_bcode"
	  			 focus-auto="focus.barcode"
	  			 placeholder="条码"
	  			 barcode-scanner
	  			 scanner="barcode_scanner"/>
	  		</div>
	  	      </form>
	  	    </td>
		    
		    <td class="col-md-2 text-left vert-align">
		      <span ng-if="!inv.$new">{{inv.full_name}}</span>
		      <form name="inv.form.good" ng-if="inv.$new">
			<div ng-class="{'has-error':inv.form.good.$invalid
				       && !inv.form.good.$pristine}">
			  <input class="form-control text-left" type="text"
				 required
				 x-ng-model="inv.full_name"
				 focus-auto="focus.style_number"
				 placeholder="货号"
				 typeahead-editable="false"
				 typeahead-on-select="on_select_good($item, $model, $label)"
				 typeahead-wait-ms="300"
				 typeahead-loading="loading"
				 uib-typeahead="g as g.name for g in match_style_number($viewValue)"/>
			  <span x-ng-show="loading">
			    <i class="glyphicon glyphicon-refresh"></i>
			  </span>
			</div>
		      </form>
		    </td>
		    
		    <td class="col-md-1 vert-align">{{seasons[inv.season]}}</td>
		    <td class="col-md-1 vert-align">
		      <span x-ng-if="!inv.style_number"></span>
		      <select x-ng-if="inv.style_number" class="form-control" type="text"
	  		      x-ng-model="inv.color"
	  		      x-ng-options="c as c.cname for c in inv.colors|filter:$viewValue"
			      x-ng-change="save_draft()">
		      </select>
		    </td>
		    <td class="col-md-1 vert-align">
		      <span x-ng-if="!inv.style_number"></span>
		      <select x-ng-if="inv.style_number" class="form-control" type="text"
	  		      x-ng-model="inv.size"
	  		      x-ng-options="s for s in inv.sizes"
			      x-ng-change="save_draft()">
		      </select>
		    </td>
		    
		    <td class="col-md-1 vert-align">
		      <span x-ng-if="!inv.style_number"></span>
		      <form x-ng-if="inv.style_number" name="inv.form.sell">
			  <div ng-class="{'has-error': inv.form.fix.$invalid
					 && !inv.form.fix.$pristine}">
			    <input type="number"
				   step="1"
				   class="form-control"
				   placeholder="数量"
				   required
				   disable-key
				   x-ng-model="inv.fix"
				   focus-auto="focus.fix" 
				   x-ng-change="auto_save_free(inv)" />
			  </div>
			</form>
		    </td>
		    
		    <td class="col-md-1 vert-align">{{inv.tag_price}}</td> 
		    <td class="col-md-1 text-left vert-align">
		      <div x-ng-if="inv.$new"> 
			<button class="btn diablo-input-button btn-warning"
			   x-ng-disabled="!inv.style_number"
			   x-ng-click="reset_inventory(inv)">重置
			  <i class="glyphicon glyphicon-pushpin"></i></button>
		      </div>

		      <div ng-if="!inv.$new"> 
			<button class="btn diablo-input-button btn-danger"
			   x-ng-if="!inv.free_update"
			   x-ng-click="delete_inventory(inv)">删除
			  <i class="glyphicon glyphicon-erase"></i></button> 
		      </div>
		      
		    </td>
		  </tr>

		  <tr x-ng-if="inventories.length>1" class="text-center">
		    
		  </tr>
		</tbody>

		<tfoot>
		</tfoot>
		
	      </table> <!--END supplier table-->
	    </div> <!--END table responsive-->
	    
	  </div> <!--END panel-->
	</div> <!--END portlet body-->
      </div> <!--END table container-->
      
    </div>
  </div>
</div>


<!-- <script type="text/ng-template" id="inventory-fix.html"> -->
<!--   <div class="modal-body">  -->
<!--     <div class="table-responsive"> -->
<!--       <table class="table table-bordered table-striped table-condensed table-advanced"> -->
<!-- 	<tbody> -->
<!-- 	  <tr> -->
<!-- 	    <td></td> -->
<!-- 	    <td x-ng-repeat="s in params.sizes" x-ng-switch on="s"> -->
<!-- 	      <span x-ng-switch-when="0">均码</span> -->
<!-- 	      <span x-ng-switch-default>{{s}}</span> -->
<!-- 	    </td> -->
<!-- 	  </tr> -->
	  
<!-- 	  <tr x-ng-repeat="c in params.colors"> -->
<!-- 	    <td x-ng-show="params.large_size"x-ng-switch on="c.cid"> -->
<!-- 	      <span x-ng-switch-when="0">均色</span> -->
<!-- 	      <span x-ng-switch-default>{{c.cname}}</span> -->
<!-- 	    </td> -->

<!-- 	    <td x-ng-show="!params.large_size" class="col-md-1" x-ng-switch on="c.cid"> -->
<!-- 	      <span x-ng-switch-when="0">均色</span> -->
<!-- 	      <span x-ng-switch-default>{{c.cname}}</span> -->
<!-- 	    </td> -->
	    
<!-- 	    <td x-ng-repeat="s in params.sizes"> -->
<!-- 	      <div x-ng-if="amount=params.get_amount(c.cid, s, params.amounts); amount">  -->
<!-- 		<div class="input-group"> -->
<!-- 		  <span class="input-group-addon modal-input-group-addon">{{amount.count}}</span>  -->
<!-- 		  <span ng-class="{'has-error': !params.valid_fixed(amount)}"> -->
<!-- 		    <input x-ng-if="amount" -->
<!-- 			   required -->
<!-- 			   class="form-control modal-input text-center" -->
<!-- 			   type="text" -->
<!-- 			   x-ng-model="amount.fixed_count" -->
<!-- 			   x-ng-enter="params.valid_all(params.amounts) && ok()" -->
<!-- 			   focus-auto="s===params.sizes[0] && c.cid===params.colors[0].cid"/> -->
<!-- 		  </span> -->
<!-- 		</div> -->
<!-- 	      </div>  -->
<!-- 	    </td> -->
<!-- 	  </tr> -->
<!-- 	</tbody>  -->
<!--       </table> -->
<!--     </div> -->
<!--   </div> -->

<!--   <div class="modal-footer"> -->
<!--     <button class="btn btn-primary" -->
<!-- 	    x-ng-disabled="!params.valid_all(params.amounts)"  -->
<!-- 	    x-ng-click="ok()">确认</button> -->
<!--     <button class="btn btn-warning" x-ng-click="cancel()">取消</button> -->
<!--   </div> -->
<!-- </script> -->


<!-- <script type="text/ng-template" id="inventory-fix-detail.html"> -->
<!--   <div class="modal-body">     -->
<!--     <div class="table-responsive"> -->
<!--       <table class="table table-bordered table-striped table-condensed table-advanced"> -->
<!-- 	<tbody> -->
<!-- 	  <tr> -->
<!-- 	    <td></td> -->
<!-- 	    <td x-ng-repeat="s in params.sizes" x-ng-switch on="s"> -->
<!-- 	      <span x-ng-switch-when="0">均码</span> -->
<!-- 	      <span x-ng-switch-default>{{s}}</span> -->
<!-- 	    </td> -->
<!-- 	  </tr> -->
	  
<!-- 	  <tr x-ng-repeat="c in params.colors">  -->
<!-- 	    <td x-ng-show="params.large_size"x-ng-switch on="c.cid"> -->
<!-- 	      <span x-ng-switch-when="0">均色</span> -->
<!-- 	      <span x-ng-switch-default>{{c.cname}}</span> -->
<!-- 	    </td> -->

<!-- 	    <td x-ng-show="!params.large_size" class="col-md-1" x-ng-switch on="c.cid"> -->
<!-- 	      <span x-ng-switch-when="0">均色</span> -->
<!-- 	      <span x-ng-switch-default>{{c.cname}}</span> -->
<!-- 	    </td> -->
	    
<!-- 	    <td x-ng-repeat="s in params.sizes"> -->
<!-- 	      <div x-ng-if="amount=params.get_amount(c.cid, s, params.amounts); amount"> -->
<!-- 		<span>{{amount.count}}</span> -->
<!-- 		<span x-ng-if="amount.fixed_count-amount.count<0"> -->
<!-- 		  <span class="badge bg-red">{{amount.fixed_count}}</span> -->
<!-- 		</span> -->
<!-- 		<span x-ng-if="amount.fixed_count-amount.count>0"> -->
<!-- 		  <span class="badge bg-yellow">{{amount.fixed_count}}</span> -->
<!-- 		</span> -->
<!-- 	      </div>  -->
<!-- 	    </td> -->
<!-- 	  </tr> -->
<!-- 	</tbody> -->
<!--       </table> -->
<!--     </div> -->
<!--   </div> -->

<!--   <div class="modal-footer"> -->
<!--     <button class="btn btn-primary" x-ng-click="ok()">保存</button> -->
<!--     <button class="btn btn-warning" x-ng-click="cancel()">取消</button> -->
<!--   </div> -->
<!-- </script> -->


<!-- <script type="text/ng-template" id="wfix-draft.html"> -->
<!--   <div class="modal-body"> -->
<!--     <div class="table-responsive"> -->
<!--       <table class="table table-bordered table-striped table-condensed table-advanced"> -->
<!-- 	<thead> -->
<!-- 	  <tr> -->
<!-- 	    <th></th> -->
<!-- 	    <th>单号</th>  -->
<!-- 	    <th>店员</th> -->
<!-- 	    <th>店铺</th> -->
<!-- 	  </tr> -->
<!-- 	</thead> -->
<!-- 	<tbody> -->
<!-- 	  <tr x-ng-repeat="d in params.drafts"> -->
<!-- 	    <td class="vert-align"> -->
<!-- 	      <div class="checkbox checkbox-danger checkbox-circle"> -->
<!-- 		<input id={{d.sn}} -->
<!-- 		       type="checkbox" -->
<!-- 		       x-ng-model="d.select" -->
<!-- 		       x-ng-click="params.select(params.drafts, d)"/> -->
<!-- 		<label for={{d.sn}}></label> -->
<!-- 	      </div> -->
<!-- 	    </td> -->
<!-- 	    <td>{{d.sn}}</td>  -->
<!-- 	    <td>{{d.employee.name}}</td> -->
<!-- 	    <td>{{d.shop.name}}</td>  -->
<!-- 	  </tr> -->
<!-- 	</tbody> -->
<!--       </table> -->
<!--     </div> -->
<!--   </div> -->

<!--   <div class="modal-footer"> -->
<!--     <button class="btn btn-primary" -->
<!-- 	    x-ng-disabled="!params.valid(params.drafts)" -->
<!-- 	    x-ng-click="ok()">确定</button> -->
<!--     <button class="btn btn-warning" x-ng-click="cancel()">取消</button> -->
<!--   </div> -->
<!-- </script> -->
